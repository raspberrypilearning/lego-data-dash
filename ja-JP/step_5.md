## LED でスケールを作る

データを表示するもう1つのとても良い方法は、1列に並んだLEDを使用して、読み取り値の変化に応じてLEDのオンとオフを切り替えることです。読み取り値が高いほどたくさんのLEDが点灯します。コンピュータが音楽の音量を表示するグラフィックイコライザーのようなものです。

![上下に動くグラフィックイコライザーを示す画像](https://media.giphy.com/media/Hzt1XTt6gilFlK8Oea/giphy.gif)

LEDディスプレイを作るには、LED電球がいくつか必要です。電球が多いほど、スケールは正確になっていきます。 ただしこれには上限があり、使用可能なGPIOピンの数だけLEDが使用できます。 この例では5個のLEDを使用していますが、10個以上接続すること**も**できます。

**注:** Build HATの設計により、 **GPIO 14 と 15(ピン 8 と 10) にはアクセスできません**。

--- task ---

LED 、抵抗、 オス-メスのジャンパーケーブル、ブレッドボードを用意します。 ![机に Raspberry Pi と Build HAT 、ブレッドボード、 LED 、ジャンパーケーブルが置かれている画像。](images/LEDbuild1.jpg)

--- /task ---

--- task ---

LEDをよく見ると、片方の脚がもう片方の脚よりも長いことがわかります。 ![机の上のLEDを拡大した画像。](images/LEDbuild2.jpg)

--- /task ---

--- task ---

LED の**短い脚**を、ブレッドボードの端に沿った**コモングラウンドレール** (一番端の青い線の隣にあります) に差し込み、長い脚を番号が一番近い行に差し込みます。 ![ブレッドボードに並んだ LED を示す画像。](images/LEDbuild3.jpg)

--- /task ---

LED が過負荷になって、焼けたり破裂するのを防ぐために、回路に抵抗を追加する必要があります。 今やるのがちょうどいいタイミングです。

--- task ---

抵抗を取り出し、並びの最初にあるLEDと**同じ行**に、片方を差し込みます。 そして、抵抗のもう片方を同じ行に差し込みますが、次に示すように、ブレッドボードの**溝をはさんだ反対側**に差し込みます:

![ブレッドボードに LED が並んでいて、最初の列に抵抗が接続されている様子を示す画像。](images/LEDbuild4.jpg)

並んでいる他のLEDも同じように取り付けます: ![ブレッドボードにLEDが並んでいて、抵抗が列につながっている様子を示す画像。](images/LEDbuildX.jpg)

--- /task ---

--- task ---

オス-メスのジャンパーケーブルのオス側を抵抗と同じ行に差し込み、 Raspberry Pi のピンに接続できるようにします: ![ブレッドボードにLEDが並んでいて、抵抗が列につながり、ジャンパーケーブルがブレッドボードから引き通されている様子を示す画像。](images/LEDbuild5.jpg)

--- /task ---

--- task ---

別のジャンパーケーブルのオス側を、コモングラウンドレールの端に差し込みます: ![ブレッドボードのコモングラウンドレールから伸びるジャンパーケーブルを示す画像。](images/LEDbuild6.jpg)

--- /task ---

完成したLEDスケールは次のようになります:

![ブレッドボードにLEDが並んでいて、抵抗が列につながり、ジャンパーケーブルがブレッドボードから引き通されている様子を示す画像。](images/LEDbuild7.jpg)

次のステップは、 Raspberry Pi の GPIO ピンに接続することです。

--- task ---

コモングラウンドレールに接続されているジャンパーケーブルのメス側を、ピン39に接続します。 これは Raspberry Pi にいくつかある グラウンドピンの1つで、**すべての** LED 電球にアースを提供します。 ![Raspberry Pi のピン 39 に接続された黒いジャンパーケーブルを示す画像。](images/LEDbuild9.jpg)

--- /task ---

--- task ---

LED を接続したケーブルを確認しながら、残りのケーブルを番号付きの GPIO ピンに接続します。

今回は、ピン16、19、20、21、26を使用しました (整頓しまとめて端に配置するため): ![Raspberry Pi の GPIO ピンから引き通したジャンパーケーブルを示す画像。](images/LEDbuild10.jpg)

--- /task ---

LED の列が Raspberry Pi に接続されたので、電源を入れてプログラムを作成しましょう。

--- task ---

7.5V 電源を Build HAT のバレルジャックに接続します。 Raspberry Pi の電源がオンになり、 Raspberry Pi OS のデスクトップが読み込まれます。

--- /task ---

--- task ---

**プログラミングメニュー** から **Thonny** を開きます。

スクリプトの最初の数行では、 gpiozero と randint ライブラリをインポートし、 LED を制御できるように設定します。 LED が接続されているピン番号と一致するように、かっこ内の値を変更する必要があります。 **注:** これらの番号の順序は重要です！ ピン番号は、「棒グラフ」の最小値から最大値の順になります。

空白のウィンドウに、次のコードを入力します。

--- code ---
---
language: python filename: led_bargraph.py line_numbers: true line_number_start: 1
line_highlights:
---
from gpiozero import LEDBarGraph from random import randint

graph = LEDBarGraph(16, 19, 20, 21, 26) #この数字の順番は、接続したピンと一致させる必要があります

--- /code ---

--- /task ---

LED のプログラムを作成する準備ができたので、測定したいデータの取得を作成するためのコードを作成します。そして、取得した結果に応じて点灯させる LED の数を決めます。 テストするだけのときは、ランダムなデータを使用しましょう。

やることは、読み取り値が増加したらLEDをオンにして、読み取り値が減少したらオフにすることです。 他のインジケータと同様に、データをスケール全体にマッピングする必要があります。

--- task ---

スクリプトの最後に次のコードを入力しましょう:

--- code ---
---
language: python filename: led_sequence.py line_numbers: true line_number_start: 9
line_highlights:
---
while True: data_reading = randint(0, 100) graph.value = 1/data_reading #ここで表示するグラフのための10進数の値が作成されます sleep(0.5) --- /code ---

--- /task ---

--- task ---

コードを `led_sequence.py` として保存して、 **Run**をクリックします。 棒グラフが点灯し始めるでしょう！

![LEDで作られた棒グラフが変化する様子を示すアニメーション画像。](images/LEDbuild.gif)

--- /task ---

--- save ---
